<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>Linux配置机器学习环境 | LanceDai's blog</title><meta name="description" content="Linux配置机器学习环境"><meta name="keywords" content="CentOS,机器学习,machine learning,linux"><meta name="author" content="Lance Dai"><meta name="copyright" content="Lance Dai"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/logo.svg"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="canonical" href="https://www.blog.lancedai.cn/2018/10/16/Linux%E9%85%8D%E7%BD%AE-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%8E%AF%E5%A2%83/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="Linux配置机器学习环境"><meta name="twitter:description" content="Linux配置机器学习环境"><meta name="twitter:image" content="https://www.blog.lancedai.cn/img/avatar.jpg"><meta property="og:type" content="article"><meta property="og:title" content="Linux配置机器学习环境"><meta property="og:url" content="https://www.blog.lancedai.cn/2018/10/16/Linux%E9%85%8D%E7%BD%AE-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%8E%AF%E5%A2%83/"><meta property="og:site_name" content="LanceDai's blog"><meta property="og:description" content="Linux配置机器学习环境"><meta property="og:image" content="https://www.blog.lancedai.cn/img/avatar.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="prev" title="Linux配置Tomcat" href="https://www.blog.lancedai.cn/2018/10/16/Linux%E9%85%8D%E7%BD%AE-Tomcat/"><link rel="next" title="Markdown公式" href="https://www.blog.lancedai.cn/2018/10/15/Markdown-%E5%85%AC%E5%BC%8F/"><link rel="stylesheet" href="https://fonts.lug.ustc.edu.cn/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight_copy: 'true',
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: '添加书签',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天'

  
}</script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#linux配置机器学习环境"><span class="toc-number">1.</span> <span class="toc-text"> Linux配置机器学习环境</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#配置python36和pip3"><span class="toc-number">1.1.</span> <span class="toc-text"> 配置Python3.6和pip3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#安装epel和ius软件源"><span class="toc-number">1.1.1.</span> <span class="toc-text"> 安装EPEL和IUS软件源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#安装python36"><span class="toc-number">1.1.2.</span> <span class="toc-text"> 安装Python3.6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#创建python3连接符"><span class="toc-number">1.1.3.</span> <span class="toc-text"> 创建python3连接符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#安装pip3"><span class="toc-number">1.1.4.</span> <span class="toc-text"> 安装pip3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#创建pip3链接符"><span class="toc-number">1.1.5.</span> <span class="toc-text"> 创建pip3链接符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#测试"><span class="toc-number">1.1.6.</span> <span class="toc-text"> 测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装tensorflow-keras-pillow-requests"><span class="toc-number">1.2.</span> <span class="toc-text"> 安装tensorflow、keras、pillow、requests</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#运行样例"><span class="toc-number">1.2.1.</span> <span class="toc-text"> 运行样例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#识别的图像"><span class="toc-number">1.2.2.</span> <span class="toc-text"> 识别的图像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#运行结果"><span class="toc-number">1.2.3.</span> <span class="toc-text"> 运行结果</span></a></li></ol></li></ol></li></ol></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/Photo/post.png)"><div id="page-header"><span class="pull-left"> <a class="blog_title" id="site-name" href="/">LanceDai's blog</a></span><div class="open toggle-menu pull-right"><div class="menu-icon-first"></div><div class="menu-icon-second"></div><div class="menu-icon-third"></div></div><span class="pull-right menus"><div class="mobile_author_icon"><img class="lozad" data-src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'"><div class="mobile_author-info__description">这是一个个人博客, 分享学习到的一切</div></div><hr><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a><script>document.body.addEventListener('touchstart', function(){ });</script></div></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title"><div class="posttitle">Linux配置机器学习环境</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2018-10-16<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> 更新于 2019-10-28</time><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">1k</span><span class="post-meta__separator">|</span><span>阅读时长: 6 分钟</span><span class="post-meta__separator">|</span><span>阅读量: </span><span id="busuanzi_value_page_pv"></span></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="linux&#x914D;&#x7F6E;&#x673A;&#x5668;&#x5B66;&#x4E60;&#x73AF;&#x5883;"><a class="markdownIt-Anchor" href="#linux&#x914D;&#x7F6E;&#x673A;&#x5668;&#x5B66;&#x4E60;&#x73AF;&#x5883;"></a> Linux&#x914D;&#x7F6E;&#x673A;&#x5668;&#x5B66;&#x4E60;&#x73AF;&#x5883;</h1>
<p><strong>&#x535A;&#x4E3B;&#x91C7;&#x7528;&#x7684;&#x7684;&#x662F;Centos</strong></p>
<h2 id="&#x914D;&#x7F6E;python36&#x548C;pip3"><a class="markdownIt-Anchor" href="#&#x914D;&#x7F6E;python36&#x548C;pip3"></a> &#x914D;&#x7F6E;Python3.6&#x548C;pip3</h2>
<h3 id="&#x5B89;&#x88C5;epel&#x548C;ius&#x8F6F;&#x4EF6;&#x6E90;"><a class="markdownIt-Anchor" href="#&#x5B89;&#x88C5;epel&#x548C;ius&#x8F6F;&#x4EF6;&#x6E90;"></a> &#x5B89;&#x88C5;EPEL&#x548C;IUS&#x8F6F;&#x4EF6;&#x6E90;</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@Lance ~]<span class="comment"># yum install epel-release -y</span></span><br><span class="line">[root@Lance ~]<span class="comment"># yum install https://centos7.iuscommunity.org/ius-release.rpm -y</span></span><br></pre></td></tr></table></figure>
<h3 id="&#x5B89;&#x88C5;python36"><a class="markdownIt-Anchor" href="#&#x5B89;&#x88C5;python36"></a> &#x5B89;&#x88C5;Python3.6</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@Lance ~]<span class="comment"># yum install python36u -y</span></span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h3 id="&#x521B;&#x5EFA;python3&#x8FDE;&#x63A5;&#x7B26;"><a class="markdownIt-Anchor" href="#&#x521B;&#x5EFA;python3&#x8FDE;&#x63A5;&#x7B26;"></a> &#x521B;&#x5EFA;python3&#x8FDE;&#x63A5;&#x7B26;</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@Lance ~]<span class="comment"># ln -s /bin/python3.6 /bin/python3</span></span><br></pre></td></tr></table></figure>
<h3 id="&#x5B89;&#x88C5;pip3"><a class="markdownIt-Anchor" href="#&#x5B89;&#x88C5;pip3"></a> &#x5B89;&#x88C5;pip3</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@Lance ~]<span class="comment"># yum install python36u-pip -y</span></span><br></pre></td></tr></table></figure>
<h3 id="&#x521B;&#x5EFA;pip3&#x94FE;&#x63A5;&#x7B26;"><a class="markdownIt-Anchor" href="#&#x521B;&#x5EFA;pip3&#x94FE;&#x63A5;&#x7B26;"></a> &#x521B;&#x5EFA;pip3&#x94FE;&#x63A5;&#x7B26;</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@Lance ~]<span class="comment"># ln -s /bin/pip3.6 /bin/pip3</span></span><br></pre></td></tr></table></figure>
<h3 id="&#x6D4B;&#x8BD5;"><a class="markdownIt-Anchor" href="#&#x6D4B;&#x8BD5;"></a> &#x6D4B;&#x8BD5;</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@Lance ~]<span class="comment"># python3 </span></span><br><span class="line">Python 3.6.5 (default, Apr 10 2018, 17:08:37) </span><br><span class="line">[GCC 4.8.5 20150623 (Red Hat 4.8.5-16)] on linux</span><br><span class="line">Type <span class="string">&quot;help&quot;</span>, <span class="string">&quot;copyright&quot;</span>, <span class="string">&quot;credits&quot;</span> or <span class="string">&quot;license&quot;</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@Lance ~]<span class="comment"># pip3</span></span><br><span class="line"></span><br><span class="line">Usage:   </span><br><span class="line">  pip &lt;<span class="built_in">command</span>&gt; [options]</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">  install                     Install packages.</span><br><span class="line">  download                    Download packages.</span><br><span class="line">  uninstall                   Uninstall packages.</span><br><span class="line">  freeze                      Output installed packages <span class="keyword">in</span> requirements format.</span><br><span class="line">  list                        List installed packages.</span><br><span class="line">  show                        Show information about installed packages.</span><br><span class="line">  check                       Verify installed packages have compatible dependencies.</span><br><span class="line">  search                      Search PyPI <span class="keyword">for</span> packages.</span><br><span class="line">  wheel                       Build wheels from your requirements.</span><br><span class="line">  <span class="built_in">hash</span>                        Compute hashes of package archives.</span><br><span class="line">  completion                  A helper <span class="built_in">command</span> used <span class="keyword">for</span> <span class="built_in">command</span> completion.</span><br><span class="line">  <span class="built_in">help</span>                        Show <span class="built_in">help</span> <span class="keyword">for</span> commands.</span><br><span class="line"></span><br><span class="line">General Options:</span><br><span class="line">  -h, --<span class="built_in">help</span>                  Show <span class="built_in">help</span>.</span><br><span class="line">  --isolated                  Run pip <span class="keyword">in</span> an isolated mode,</span><br><span class="line">                              ignoring environment variables and</span><br><span class="line">                              user configuration.</span><br><span class="line">  -v, --verbose               Give more output. Option is</span><br><span class="line">                              additive, and can be used up to 3</span><br><span class="line">                              <span class="built_in">times</span>.</span><br><span class="line">  -V, --version               Show version and <span class="built_in">exit</span>.</span><br><span class="line">  -q, --quiet                 Give less output. Option is</span><br><span class="line">                              additive, and can be used up to 3</span><br><span class="line">                              <span class="built_in">times</span> (corresponding to WARNING,</span><br><span class="line">                              ERROR, and CRITICAL logging</span><br><span class="line">                              levels).</span><br><span class="line">  --<span class="built_in">log</span> &lt;path&gt;                Path to a verbose appending <span class="built_in">log</span>.</span><br><span class="line">  --proxy &lt;proxy&gt;             Specify a proxy <span class="keyword">in</span> the form</span><br><span class="line">                              [user:passwd@]proxy.server:port.</span><br><span class="line">  --retries &lt;retries&gt;         Maximum number of retries each</span><br><span class="line">                              connection should attempt (default</span><br><span class="line">                              5 <span class="built_in">times</span>).</span><br><span class="line">  --timeout &lt;sec&gt;             Set the socket timeout (default 15</span><br><span class="line">                              seconds).</span><br><span class="line">  --exists-action &lt;action&gt;    Default action when a path already</span><br><span class="line">                              exists: (s)witch, (i)gnore,</span><br><span class="line">                              (w)ipe, (b)ackup, (a)bort.</span><br><span class="line">  --trusted-host &lt;hostname&gt;   Mark this host as trusted, even</span><br><span class="line">                              though it does not have valid or</span><br><span class="line">                              any HTTPS.</span><br><span class="line">  --cert &lt;path&gt;               Path to alternate CA bundle.</span><br><span class="line">  --client-cert &lt;path&gt;        Path to SSL client certificate, a</span><br><span class="line">                              single file containing the private</span><br><span class="line">                              key and the certificate <span class="keyword">in</span> PEM</span><br><span class="line">                              format.</span><br><span class="line">  --cache-dir &lt;dir&gt;           Store the cache data <span class="keyword">in</span> &lt;dir&gt;.</span><br><span class="line">  --no-cache-dir              Disable the cache.</span><br><span class="line">  --<span class="built_in">disable</span>-pip-version-check</span><br><span class="line">                              Don<span class="string">&apos;t periodically check PyPI to</span></span><br><span class="line"><span class="string">                              determine whether a new version of</span></span><br><span class="line"><span class="string">                              pip is available for download.</span></span><br><span class="line"><span class="string">                              Implied with --no-index.</span></span><br></pre></td></tr></table></figure>
<h2 id="&#x5B89;&#x88C5;tensorflow-keras-pillow-requests"><a class="markdownIt-Anchor" href="#&#x5B89;&#x88C5;tensorflow-keras-pillow-requests"></a> &#x5B89;&#x88C5;<code>tensorflow&#x3001;keras&#x3001;pillow&#x3001;requests</code></h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@Lance ~]<span class="comment"># pip3 install tensorflow</span></span><br><span class="line">[root@Lance ~]<span class="comment"># pip3 install keras</span></span><br><span class="line">[root@Lance ~]<span class="comment"># pip3 install pillow</span></span><br><span class="line">[root@Lance ~]<span class="comment"># pip3 install requests</span></span><br></pre></td></tr></table></figure>
<h3 id="&#x8FD0;&#x884C;&#x6837;&#x4F8B;"><a class="markdownIt-Anchor" href="#&#x8FD0;&#x884C;&#x6837;&#x4F8B;"></a> &#x8FD0;&#x884C;&#x6837;&#x4F8B;</h3>
<p>&#x4E00;&#x4E2A;&#x56FE;&#x50CF;&#x8BC6;&#x522B;&#x7A0B;&#x5E8F;</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> keras.preprocessing <span class="keyword">import</span> image</span><br><span class="line"><span class="keyword">from</span> keras.applications.resnet50 <span class="keyword">import</span> ResNet50, preprocess_input, decode_predictions</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.environ[<span class="string">&apos;CUDA_VISIBLE_DEVICES&apos;</span>] = <span class="string">&quot;0&quot;</span></span><br><span class="line"><span class="comment"># &#x6DFB;&#x52A0;tensorflow &#x5BF9;CPU&#x7684;&#x652F;&#x6301;</span></span><br><span class="line">os.environ[<span class="string">&apos;TF_CPP_MIN_LOG_LEVEL&apos;</span>] = <span class="string">&apos;2&apos;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># &#x4F7F;&#x7528;&#x5728;ImageNet ILSVRC&#x6BD4;&#x8D5B;&#x4E2D;&#x5DF2;&#x7ECF;&#x8BAD;&#x7EC3;&#x597D;&#x7684;&#x6743;&#x91CD;</span></span><br><span class="line">model = ResNet50(weights=<span class="string">&apos;imagenet&apos;</span>)</span><br><span class="line"><span class="comment"># &#x8F93;&#x5165;&#x5927;&#x5C0F;</span></span><br><span class="line">target_size = (<span class="number">224</span>, <span class="number">224</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># &#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x9884;&#x6D4B;&#x51FD;&#x6570;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(model, img, target_size, top_n=<span class="number">10</span>)</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;Run model prediction on image</span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">      model: keras model</span></span><br><span class="line"><span class="string">      img: PIL format image</span></span><br><span class="line"><span class="string">      target_size: (w,h) tuple</span></span><br><span class="line"><span class="string">      top_n: # of top predictions to return</span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">      list of predicted labels and their probabilities</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> img.size != target_size:</span><br><span class="line">        img = img.resize(target_size)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># image.img_to_array&#xFF1A;&#x5C06;PIL&#x683C;&#x5F0F;&#x7684;&#x56FE;&#x50CF;&#x8F6C;&#x6362;&#x4E3A;numpy&#x6570;&#x7EC4;&#x3002;</span></span><br><span class="line">    x = image.img_to_array(img)</span><br><span class="line">    <span class="comment"># np.expand_dims&#xFF1A;&#x5C06;&#x6211;&#x4EEC;&#x7684;(3&#xFF0C;224&#xFF0C;224)&#x5927;&#x5C0F;&#x7684;&#x56FE;&#x50CF;&#x8F6C;&#x6362;&#x4E3A;(1&#xFF0C;3&#xFF0C;224&#xFF0C;224)&#x3002;</span></span><br><span class="line">    <span class="comment"># &#x56E0;&#x4E3A;model.predict&#x51FD;&#x6570;&#x9700;&#x8981;4&#x7EF4;&#x6570;&#x7EC4;&#x4F5C;&#x4E3A;&#x8F93;&#x5165;&#xFF0C;</span></span><br><span class="line">    <span class="comment"># &#x5176;&#x4E2D;&#x7B2C;4&#x7EF4;&#x4E3A;&#x6BCF;&#x6279;&#x9884;&#x6D4B;&#x56FE;&#x50CF;&#x7684;&#x6570;&#x91CF;&#x3002;</span></span><br><span class="line">    <span class="comment"># &#x8FD9;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4E00;&#x6B21;&#x6027;&#x5206;&#x7C7B;&#x591A;&#x4E2A;&#x56FE;&#x50CF;&#x3002;</span></span><br><span class="line">    x = np.expand_dims(x, axis=<span class="number">0</span>)</span><br><span class="line">    <span class="comment"># preprocess_input&#xFF1A;&#x4F7F;&#x7528;&#x8BAD;&#x7EC3;&#x6570;&#x636E;&#x96C6;&#x4E2D;&#x7684;&#x5E73;&#x5747;&#x901A;&#x9053;&#x503C;&#x5BF9;&#x56FE;&#x50CF;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x96F6;&#x503C;&#x5904;&#x7406;&#xFF0C;</span></span><br><span class="line">    <span class="comment"># &#x5373;&#x4F7F;&#x5F97;&#x56FE;&#x50CF;&#x6240;&#x6709;&#x70B9;&#x7684;&#x548C;&#x4E3A;0&#x3002;&#x8FD9;&#x662F;&#x975E;&#x5E38;&#x91CD;&#x8981;&#x7684;&#x6B65;&#x9AA4;&#xFF0C;</span></span><br><span class="line">    <span class="comment"># &#x5982;&#x679C;&#x8DF3;&#x8FC7;&#xFF0C;&#x5C06;&#x5927;&#x5927;&#x5F71;&#x54CD;&#x5B9E;&#x9645;&#x9884;&#x6D4B;&#x6548;&#x679C;&#x3002;</span></span><br><span class="line">    <span class="comment"># &#x8FD9;&#x4E2A;&#x6B65;&#x9AA4;&#x79F0;&#x4E3A;&#x6570;&#x636E;&#x5F52;&#x4E00;&#x5316;&#x3002;</span></span><br><span class="line">    x = preprocess_input(x)</span><br><span class="line">    <span class="comment"># model.predict&#xFF1A;&#x5BF9;&#x6211;&#x4EEC;&#x7684;&#x6570;&#x636E;&#x5206;&#x6279;&#x5904;&#x7406;&#x5E76;&#x8FD4;&#x56DE;&#x9884;&#x6D4B;&#x503C;&#x3002;</span></span><br><span class="line">    predicts = model.predict(x)</span><br><span class="line">    <span class="comment"># &#x91C7;&#x7528;&#x4E0E;model.predict&#x51FD;&#x6570;&#x76F8;&#x540C;&#x7684;&#x7F16;&#x7801;&#x6807;&#x7B7E;&#xFF0C;</span></span><br><span class="line">    <span class="comment"># &#x5E76;&#x4ECE;ImageNet ILSVRC&#x96C6;&#x8FD4;&#x56DE;&#x53EF;&#x8BFB;&#x7684;&#x6807;&#x7B7E;&#x3002;</span></span><br><span class="line">    <span class="keyword">return</span> decode_predictions(predicts, top=top_n)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_detail</span><span class="params">(predicts)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> predicate <span class="keyword">in</span> predicts:</span><br><span class="line">        print(<span class="string">&quot;%-20s  %.3f&quot;</span> % (predicate[<span class="number">1</span>], predicate[<span class="number">2</span>]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    a = argparse.ArgumentParser()</span><br><span class="line">    a.add_argument(<span class="string">&quot;--image&quot;</span>, help=<span class="string">&quot;path to image&quot;</span>)</span><br><span class="line">    a.add_argument(<span class="string">&quot;--image_url&quot;</span>, help=<span class="string">&quot;url to image&quot;</span>)</span><br><span class="line">    args = a.parse_args()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> args.image <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">and</span> args.image_url <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        a.print_help()</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> args.image <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        img = Image.open(args.image)</span><br><span class="line">        preds = predict(model, img, target_size)</span><br><span class="line">        print_detail(preds)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> args.image_url <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        response = requests.get(args.image_url)</span><br><span class="line">        img = Image.open(BytesIO(response.content))</span><br><span class="line">        preds = predict(model, img, target_size)</span><br><span class="line">        print_detail(preds)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> args.image_url <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> args.image <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        print(<span class="string">&quot;too much args!!!&quot;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="&#x8BC6;&#x522B;&#x7684;&#x56FE;&#x50CF;"><a class="markdownIt-Anchor" href="#&#x8BC6;&#x522B;&#x7684;&#x56FE;&#x50CF;"></a> &#x8BC6;&#x522B;&#x7684;&#x56FE;&#x50CF;</h3>
<p><img src="/2018/10/16/Linux%E9%85%8D%E7%BD%AE-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%8E%AF%E5%A2%83/African_Bush_Elephant.jpg" alt="African_Bush_Elephant"></p>
<h3 id="&#x8FD0;&#x884C;&#x7ED3;&#x679C;"><a class="markdownIt-Anchor" href="#&#x8FD0;&#x884C;&#x7ED3;&#x679C;"></a> &#x8FD0;&#x884C;&#x7ED3;&#x679C;</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@Lance tmp]<span class="comment"># python3 image_identification.py --image African_Bush_Elephant.jpg </span></span><br><span class="line">Using TensorFlow backend.</span><br><span class="line">African_elephant      0.898</span><br><span class="line">tusker                0.062</span><br><span class="line">Indian_elephant       0.034</span><br><span class="line">triceratops           0.002</span><br><span class="line">megalith              0.002</span><br><span class="line">warthog               0.000</span><br><span class="line">seashore              0.000</span><br><span class="line">hippopotamus          0.000</span><br><span class="line">radio_telescope       0.000</span><br><span class="line">sandbar               0.000</span><br></pre></td></tr></table></figure>
</div></article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CentOS/">CentOS    </a><a class="post-meta__tags" href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习    </a><a class="post-meta__tags" href="/tags/machine-learning/">machine learning    </a><a class="post-meta__tags" href="/tags/linux/">linux    </a></div><div class="post_share"><div class="social-share" data-image="/img/avatar.jpg" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull-left"><a href="/2018/10/16/Linux%E9%85%8D%E7%BD%AE-Tomcat/"><img class="prev_cover lozad" data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>Linux配置Tomcat</span></div></a></div><div class="next-post pull-right"><a href="/2018/10/15/Markdown-%E5%85%AC%E5%BC%8F/"><img class="next_cover lozad" data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>Markdown公式</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span>相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2018/10/17/Linux配置-Node.js/" title="Linux配置Node.js"><img class="relatedPosts_cover lozad" data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><div class="relatedPosts_title">Linux配置Node.js</div></a></div><div class="relatedPosts_item"><a href="/2018/10/17/Linux配置-Nginx/" title="Linux Nginx配置"><img class="relatedPosts_cover lozad" data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><div class="relatedPosts_title">Linux Nginx配置</div></a></div><div class="relatedPosts_item"><a href="/2018/10/17/Linux-JAVA环境/" title="Linux配置JAVA环境"><img class="relatedPosts_cover lozad" data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><div class="relatedPosts_title">Linux配置JAVA环境</div></a></div><div class="relatedPosts_item"><a href="/2018/10/17/Linux配置-设置显示中文(以CentOS为例)/" title="Linux配置-设置显示中文(以CentOS为例)"><img class="relatedPosts_cover lozad" data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><div class="relatedPosts_title">Linux配置-设置显示中文(以CentOS为例)</div></a></div></div><div class="clear_both"></div></div></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2018 - 2020 By Lance Dai</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="footer_custom_text">Hi, welcome to my <a href="https://www.blog.lancedai.cn/">blog</a>!</div><div class="icp"><a href="http://www.beian.miit.gov.cn/state/outPortal/loginPortal.action" target="_blank" rel="noopener"><span>浙ICP备18038331号-1</span></a></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><section class="rightside" id="rightside"><i class="fa fa-book" id="readmode" title="阅读模式"> </i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><i class="fa fa-moon-o nightshift" id="nightshift" title="夜间模式"></i></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="/js/third-party/fireworks.js"></script><script src="/js/nightshift.js"></script><script id="ribbon" src="/js/third-party/canvas-ribbon.js" size="150" alpha="0.6" zIndex="-1" data-click="false"></script><script id="ribbon" src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/js/piao.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@1.2.2/instantpage.min.js" type="module"></script></body></html>